# Определение ширины функции на полувысоте методом простой итерации

## Условие задачи

Методом простой итерации найти ширину функции на полувысоте с точностью $10^{-3}$:

**б)** $f(x) = x \exp(-x^2)$, $x \geq 0$

## Решение

Ширина на полувысоте (FWHM) для функции с одним максимумом определяется как расстояние между двумя точками по обе стороны от максимума, где значение функции равно половине максимального значения:

$$
\text{FWHM} = x_2 - x_1
$$

где $f(x_1) = f(x_2) = \dfrac{f_{max}}{2}$, и $x_1 < x_{max} < x_2$

Для функции $f(x) = x e^{-x^2}$:

- **Производная:**
  
  $f'(x) = \frac{d}{dx}[x e^{-x^2}] = e^{-x^2} + x \cdot (-2x)e^{-x^2} = e^{-x^2}(1 - 2x^2)$

- **Критическая точка:**
  
  $$
  f'(x) = 0 \Rightarrow e^{-x^2}(1 - 2x^2) = 0 \Rightarrow 1 - 2x^2 = 0
  $$
  
  $$
  x^2 = \frac{1}{2} \Rightarrow x_{max} = \frac{1}{\sqrt{2}} \quad (\text{т.к. } x \geq 0)
  $$

- **Максимальное значение:**
  
  $$
  f_{max} = f(x_{max}) = \frac{1}{\sqrt{2}} \cdot e^{-1/2} = \frac{1}{\sqrt{2e}}
  $$

- **Значение на полувысоте:**
  
  $$
  f_{target} = \frac{f_{max}}{2} = \frac{1}{2\sqrt{2e}}
  $$

Требуется решить уравнение:

$$
x e^{-x^2} = \frac{1}{2\sqrt{2e}}
$$

### Метод простой итерации

Преобразуем уравнение к итерационной форме:

$$
x e^{-x^2} = t
$$

$$
e^{-x^2} = \frac{t}{x}
$$

$$
-x^2 = \ln\left(\frac{t}{x}\right)
$$

$$
x^2 = -\ln\left(\frac{t}{x}\right)
$$

$$
x = \sqrt{-\ln\left(\frac{t}{x}\right)}
$$

Получаем итерационную формулу:

$$
x_{n+1} = \sqrt{-\ln\left(\frac{t}{x_n}\right)}
$$

### Алгоритм решения

1. Вычислить $x_{max} = \frac{1}{\sqrt{2}}$ и $f_{max} = \frac{1}{\sqrt{2e}}$
2. Вычислить $t = \frac{f_{max}}{2}$
3. Найти левую точку `x_1` (используя начальное приближение $x_0 = 0.5$)
4. Найти правую точку `x_2` (используя начальное приближение $x_0 = 1.2$)
5. Вычислить $\text{FWHM} = x_2 - x_1$
   
Итерации продолжаются до выполнения условия:
$$
|x_{n+1} - x_n| < 10^{-3}
$$
